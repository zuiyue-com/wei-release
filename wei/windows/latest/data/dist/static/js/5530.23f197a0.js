/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-01-26 16:22:38
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[5530],{81464:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(81095),o=a(26593);function i(e){n.gp.$baseMessage(`拷贝${e}成功`,"success","vab-hey-message-success",!1)}function l(e){n.gp.$baseMessage(`拷贝${e}失败`,"error","vab-hey-message-success",!1)}function s(e){const{isSupported:t,copy:a}=(0,o.VPI)();t||(0,o.gIw)("clipboard-write"),a(e).then((()=>{i(e)})).catch((t=>{console.log(t),l(e)}))}},27324:function(e,t,a){a.d(t,{Z:function(){return m}});a(57658);var n=a(81095),o=a(53580),i=a(15790),l=a(26010),s=a(81464),r=a(22201),c=a(66252),u=a(2262);const d=(0,i.L)();function m(){const e=(0,r.yj)();(0,c.bv)((()=>{h()}));const t={tid:e.params.id,page:1},a={pageSize:1,total:1},i=(0,u.qj)({detail:{},images:[],comments:[],extraInfo:{},favId:0,likeId:0}),m=(0,u.iH)({});function f(e){return e?Object.values(e).map((e=>({id:e.aid,image:`${e.url}${e.attachment}`,height:e.height}))):[]}const p=(0,c.Fl)((()=>f(i.detail.attachments))),g=(0,c.Fl)((()=>i.detail.tid)),v=(0,c.Fl)((()=>i.detail.pid)),_=(0,c.Fl)((()=>i.detail.fid)),w=(0,c.Fl)((()=>d.canAction(i.detail.authorid))),y=(0,c.Fl)((()=>i.detail.tags?i.detail.tags.map((e=>({id:e[0],name:e[1]}))):[])),b=(0,c.Fl)((()=>(0,l.Gc)(t.page,a.pageSize,a.total-1)));async function h(){const{body:{list:e,threadsortshow:n,forum_thread:l,page_perpage:s,page_allcount:r}}=await(0,o.BN)(t),c=e;i.detail=c[0]??{},i.comments=c.slice(1),i.extraInfo=l,i.favId=i.detail.threadHasFavorite?.favid??0,i.likeId=i.detail.threadHasRecommend?.tid??0,a.pageSize=parseInt(s),a.total=parseInt(r),j(i.detail.attachments);const u=Object.fromEntries(Object.entries(n.optionlist).map((e=>(e[0]=e[0].replace(/^(image|model)_/,""),e))).filter((e=>e[1].value)));m.value=u}async function k(){const{body:{list:e,forum_thread:n,page_perpage:l,page_allcount:s}}=await(0,o.BN)(t);i.comments=[e[1],...i.comments],i.extraInfo=n,a.pageSize=parseInt(l),a.total=parseInt(s)}async function x(){if(b.value)return;t.page++;const{body:{list:e,page_perpage:n,page_allcount:l}}=await(0,o.BN)(t);i.comments.push(...e),a.pageSize=parseInt(n),a.total=parseInt(l)}async function S(){await(0,o.Xq)(i.favId),i.favId=0,i.extraInfo.favtimes--,n.gp.$baseMessage("取消收藏成功","success","vab-hey-message-success")}async function U(){const{body:{favid:e}}=await(0,o.l0)(t.tid);e>0?(i.favId=e,i.extraInfo.favtimes++,n.gp.$baseMessage("收藏成功","success","vab-hey-message-success")):n.gp.$baseMessage("收藏失败","error","vab-hey-message-error")}const I=(0,u.qj)({imageIndex:0,imageId:0,imageDetail:{},imageLog:{}});function j(e){const t=f(e);I.imageIndex=0,I.imageId=t[0]?t[0].id:0}function T(e){(0,l.Oo)()&&(e.preventDefault(),"A"===e.target.nodeName.toLocaleUpperCase()&&(0,s.Z)(e.target.href))}return{topicInfo:i,imageTimeline:m,images:p,getTid:g,getPid:v,getFid:_,canAction:w,getTopicTags:y,hasNoMoreData:b,loadTopic:h,loadAddedTopic:k,loadMoreComments:x,handleDelFavTopic:S,handleAddFavTopic:U,interceptLinkHref:T,imageInfo:I}}},63877:function(e,t,a){a.d(t,{Nb:function(){return i},jQ:function(){return n},jl:function(){return o}});const n={message:[{required:!0,message:"评论内容必填",trigger:"blur"}]},o={report_select:[{required:!0,message:"请选择举报类型",trigger:"blur"}],message:[{required:!0,message:"举报内容必填",trigger:"blur"},{min:8,max:255,message:"举报内容长度必须在8-255个字符",trigger:"blur"}]},i={images:[{required:!0,message:"发帖需要至少一张图片",trigger:"blur"}],subject:[{required:!0,message:"内容必填",trigger:"blur"}],tags:[{required:!0,message:"至少选择一个标签",trigger:"blur"}]}},49527:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var n=a(66252),o=a(3577),i=a(2262);const l={class:"box"};var s={__name:"index",props:{icon:{type:String,default:""},size:{type:String,default:""},text:{type:[Number,String],default:""},color:{type:String,default:""}},setup(e){const t=e,a=(0,n.Fl)((()=>{const e={fontSize:t.size};return t.color&&(e.color=t.color),e}));return(t,s)=>{const r=(0,n.up)("vab-icon");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(r,{icon:e.icon,style:(0,o.j5)((0,i.SU)(a)),class:"icon"},null,8,["icon","style"]),(0,n._)("span",{style:(0,o.j5)((0,i.SU)(a))},(0,o.zw)(e.text),5)])}}};function r(e){e.__source="src/components/IconText/index.vue"}var c=a(83744);"function"===typeof r&&r(s);const u=(0,c.Z)(s,[["__scopeId","data-v-55dcc2f6"]]);var d=u},57506:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var n=a(20129),o=(a(3241),a(69840),a(15659)),i=(a(10444),a(6589),a(57018)),l=(a(74367),a(66252)),s=a(2262),r=a(49963),c=a(63877),u=a(53580);const d={class:"form"};var m={__name:"form",props:{tid:{type:String,default:"0"}},emits:["reload"],setup(e,{expose:t,emit:a}){const m=e,f=(0,l.f3)("$baseMessage"),p=(0,s.qj)({showTextarea:!1,rules:{...c.jQ},topicFormRef:null,inputCommentRef:null,loading:!1}),g=(0,s.qj)({tid:m.tid,pid:0,message:""});(0,l.YP)((()=>m.tid),(()=>{g.tid=m.tid}));const{topicFormRef:v,inputCommentRef:_}=(0,s.BK)(p);function w(){p.showTextarea=!0,y()}function y(){p["topicFormRef"].clearValidate(),(0,l.Y3)((()=>{_.value.focus()}))}async function b(){try{p.loading=!0;const e=/@\w+ /g;e.test(g.message)?await(0,u.kA)(g):await(0,u.NY)(g),g.message="",a("reload"),f("回复成功","success","vab-hey-message-success")}catch(e){console.log(e)}finally{p.loading=!1}}async function h(){p["topicFormRef"].validate((e=>{e&&b()}))}function k(e,t){p.showTextarea=!0,g.pid=e,g.message+=`@${t} `,y()}return t({bindReplyAuthor:k}),(e,t)=>{const a=i.EZ,c=n.nH,u=o.ElButton,m=n.ly;return(0,l.wg)(),(0,l.iD)("div",d,[(0,l.Wm)(m,{ref_key:"topicFormRef",ref:v,model:(0,s.SU)(g),rules:(0,s.SU)(p).rules},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("div",null,[(0,l.Wm)(c,{prop:"message"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,{ref_key:"inputCommentRef",ref:_,modelValue:(0,s.SU)(g).message,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,s.SU)(g).message=e),placeholder:"在这里输入评论内容",type:"textarea",maxlength:"256",rows:3,"show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(u,{type:"primary",class:"button",disabled:""===(0,s.SU)(g).message,loading:(0,s.SU)(p).loading,onClick:h},{default:(0,l.w5)((()=>[(0,l.Uk)(" 评论 ")])),_:1},8,["disabled","loading"])],512),[[r.F8,(0,s.SU)(p).showTextarea]]),(0,l.wy)((0,l._)("div",null,[(0,l.Wm)(a,{placeholder:"在这里输入评论内容",onFocus:w})],512),[[r.F8,!(0,s.SU)(p).showTextarea]])])),_:1},8,["model","rules"])])}}};function f(e){e.__source="src/components/Topic/form.vue"}var p=a(83744);"function"===typeof f&&f(m);const g=(0,p.Z)(m,[["__scopeId","data-v-75d0045b"]]);var v=g},6737:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=a(10661),o=(a(3241),a(35095),a(66252)),i=a(2262),l=a(49527);const s={class:"info-box"};var r={__name:"image_actions",props:{topic:{type:Object,default:()=>{}},imageTimeline:{type:Object,default:()=>{}},canAction:{type:Boolean,default:!1}},emits:["delFav","addFav"],setup(e,{emit:t}){const a=e,{extraInfo:r,favId:c}=(0,i.BK)(a.topic);function u(){t("delFav")}function d(){t("addFav")}return(t,a)=>{const m=n.Q0;return(0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(m,{class:"box-item",effect:"dark",content:"收藏",placement:"top"},{default:(0,o.w5)((()=>[(0,o._)("div",null,[(0,i.SU)(c)>0?((0,o.wg)(),(0,o.j4)((0,i.SU)(l["default"]),{key:0,icon:"star-fill",text:(0,i.SU)(r).favtimes,color:"#B43838",class:"icon cursor-pointer",onClick:u},null,8,["text"])):((0,o.wg)(),(0,o.j4)((0,i.SU)(l["default"]),{key:1,icon:"star-line",text:(0,i.SU)(r).favtimes,color:"#B43838",class:"icon cursor-pointer",onClick:d},null,8,["text"]))])])),_:1}),e.imageTimeline.download?((0,o.wg)(),(0,o.j4)(m,{key:0,class:"box-item",effect:"dark",content:e.imageTimeline.download.title,placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,i.SU)(l["default"]),{icon:"download-2-line",text:e.imageTimeline.download.value,class:"icon"},null,8,["text"])])),_:1},8,["content"])):(0,o.kq)("",!0),(0,i.SU)(r).replies?((0,o.wg)(),(0,o.j4)(m,{key:1,class:"box-item",effect:"dark",content:"评论",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,i.SU)(l["default"]),{icon:"chat-poll-line",text:(0,i.SU)(r).replies,class:"icon"},null,8,["text"])])),_:1})):(0,o.kq)("",!0),e.imageTimeline.size?((0,o.wg)(),(0,o.j4)(m,{key:2,class:"box-item",effect:"dark",content:e.imageTimeline.size.title,placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,i.SU)(l["default"]),{icon:"database-2-line",text:e.imageTimeline.size.value,class:"icon"},null,8,["text"])])),_:1},8,["content"])):(0,o.kq)("",!0),e.imageTimeline.use?((0,o.wg)(),(0,o.j4)(m,{key:3,class:"box-item",effect:"dark",content:e.imageTimeline.use.title,placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,i.SU)(l["default"]),{icon:"file-2-line",text:e.imageTimeline.use.value,class:"icon"},null,8,["text"])])),_:1},8,["content"])):(0,o.kq)("",!0),e.imageTimeline.star?((0,o.wg)(),(0,o.j4)(m,{key:4,class:"box-item",effect:"dark",content:e.imageTimeline.star.title,placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,i.SU)(l["default"]),{icon:"user-star-line",text:e.imageTimeline.star.value,class:"icon"},null,8,["text"])])),_:1},8,["content"])):(0,o.kq)("",!0)])}}};function c(e){e.__source="src/components/Topic/image_actions.vue"}var u=a(83744);"function"===typeof c&&c(r);const d=(0,u.Z)(r,[["__scopeId","data-v-0bf094e6"]]);var m=d},93595:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var n=a(69950),o=(a(3241),a(82123),a(19615),a(66252)),i=a(2262),l=a(3577),s=a(96486);const r={class:"timeline-container"},c={class:"actions"};var u=(0,o.aZ)({__name:"image_timeline",props:{detail:{type:Object,default:()=>{}}},setup(e){const t=e,a=(0,o.Fl)((()=>(0,s.omit)(t.detail,["author","homepage","download","size","use","star"])));return(e,t)=>{const s=n._T,u=n.rJ;return(0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,i.SU)(a),((e,t)=>((0,o.wg)(),(0,o.j4)(s,{key:t,timestamp:e.value},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.title),1)])),_:2},1032,["timestamp"])))),128))])),_:1}),(0,o._)("div",c,[(0,o.WI)(e.$slots,"default")])])}}});function d(e){e.__source="src/components/Topic/image_timeline.vue"}var m=a(83744);"function"===typeof d&&d(u);const f=(0,m.Z)(u,[["__scopeId","data-v-037b1e05"]]);var p=f},16299:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=a(25917),o=(a(3241),a(27109),a(61684),a(57122)),i=(a(69540),a(66252)),l=a(2262);const s={class:"image-box"};var r={__name:"images",props:{images:{type:Array,default:()=>[]},imageIndex:{type:Number,default:0}},emits:["change"],setup(e,{emit:t}){const a=e,r=(0,i.Fl)((()=>a.images.length<=1?"never":"always")),c=(0,i.Fl)((()=>{const e=a.images.map((e=>e.height))||[];return Math.max(...e)}));function u(e){t("change",e)}return(t,a)=>{const d=o.F8,m=n.B6,f=n.$J;return(0,i.wg)(),(0,i.j4)(f,{height:(0,l.SU)(c)+"px",autoplay:!1,"initial-index":e.imageIndex,arrow:(0,l.SU)(r),"indicator-position":e.images.length>1?"":"none",onChange:u},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.images,(e=>((0,i.wg)(),(0,i.j4)(m,{key:e.id},{default:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i.Wm)(d,{src:e.image},null,8,["src"])])])),_:2},1024)))),128))])),_:1},8,["height","initial-index","arrow","indicator-position"])}}};function c(e){e.__source="src/components/Topic/images.vue"}var u=a(83744);"function"===typeof c&&c(r);const d=(0,u.Z)(r,[["__scopeId","data-v-6c37c3bc"]]);var m=d},16693:function(e,t,a){a.r(t),a.d(t,{default:function(){return v}});var n=a(73481),o=(a(3241),a(62029),a(15659)),i=(a(10444),a(20129)),l=(a(69840),a(57018)),s=(a(74367),a(6589),a(47820)),r=(a(50986),a(61715),a(66252)),c=a(2262),u=a(53580),d=a(63877);const m={class:"dialog-footer"};var f={__name:"report",setup(e,{expose:t}){const a=(0,r.f3)("$baseMessage"),f=["垃圾广告","攻击骚扰","违法违规","色情低俗","不实信息","抄袭侵权","其它"],p={report_select:"",message:"",rid:0,fid:0},g=(0,c.qj)({queryForm:{...p},rules:{...d.jl},dialogVisible:!1,formRef:null}),{queryForm:v,rules:_,dialogVisible:w,formRef:y}=(0,c.BK)(g);function b(e,t){g.dialogVisible=!0,v.value.rid=e,v.value.fid=t}function h(){g["formRef"].validate((async e=>{if(e){const e=await(0,u.yo)(v.value);a(e.msg,"success","vab-hey-message-success"),g.queryForm={...p},g.dialogVisible=!1}}))}return t({showDialog:b}),(e,t)=>{const a=s.BT,u=s.km,d=i.nH,p=l.EZ,g=i.ly,b=o.ElButton,k=n.d0;return(0,r.wg)(),(0,r.j4)(k,{modelValue:(0,c.SU)(w),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,c.dq)(w)?w.value=e:null),title:"举报帖子",width:"30%"},{footer:(0,r.w5)((()=>[(0,r._)("span",m,[(0,r.Wm)(b,{onClick:t[2]||(t[2]=e=>w.value=!1)},{default:(0,r.w5)((()=>[(0,r.Uk)("取消")])),_:1}),(0,r.Wm)(b,{type:"primary",onClick:h},{default:(0,r.w5)((()=>[(0,r.Uk)("确认")])),_:1})])])),default:(0,r.w5)((()=>[(0,r.Wm)(g,{ref_key:"formRef",ref:y,model:(0,c.SU)(v),rules:(0,c.SU)(_)},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{prop:"report_select"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{modelValue:(0,c.SU)(v).report_select,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,c.SU)(v).report_select=e),placeholder:"举报类型"},{default:(0,r.w5)((()=>[((0,r.wg)(),(0,r.iD)(r.HY,null,(0,r.Ko)(f,(e=>(0,r.Wm)(a,{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(d,{prop:"message"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{modelValue:(0,c.SU)(v).message,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,c.SU)(v).message=e),rows:3,type:"textarea",placeholder:"举报内容"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}}};function p(e){e.__source="src/components/Topic/report.vue"}"function"===typeof p&&p(f);const g=f;var v=g},1479:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var n=a(57534),o=(a(3241),a(92471),a(15659)),i=(a(10444),a(77669)),l=(a(95774),a(66252)),s=a(2262),r=a(3577),c=a(15904),u=a(15790);const d={key:0,class:"item"},m={class:"row"},f={class:"name"},p={class:"author"},g=["innerHTML"],v={key:0},_={class:"content"},w={class:"tags-box"};var y={__name:"topic",props:{topic:{type:Object,default:()=>{}},canAction:{type:Boolean,default:!1},tags:{type:Array,default:()=>[]}},setup(e){const t=e,a=(0,u.L)(),y=(0,l.Fl)((()=>t.topic)),b=(0,l.Fl)((()=>(0,c.x)(t.topic.detail))),h=(0,l.Fl)((()=>parseInt(y.value.extraInfo.follow_record)>0)),k=(0,l.Fl)((()=>y.value.detail.authorid));async function x(){await a.handleAddFollowUser(k.value),y.value.extraInfo.follow_record=1}async function S(){await a.handleDelFollowUser(k.value),y.value.extraInfo.follow_record=0}return(t,a)=>{const c=i.vs,u=(0,l.up)("router-link"),y=(0,l.up)("vab-icon"),k=o.ElButton,U=n.Ks;return(0,s.SU)(b)?((0,l.wg)(),(0,l.iD)("div",d,[(0,l._)("div",m,[(0,l.Wm)(u,{to:(0,s.SU)(b).author_route},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{src:(0,s.SU)(b).avatar},null,8,["src"])])),_:1},8,["to"]),(0,l._)("div",f,[(0,l.Wm)(u,{to:(0,s.SU)(b).author_route},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,r.zw)((0,s.SU)(b).author),1)])),_:1},8,["to"]),(0,l._)("div",{innerHTML:(0,s.SU)(b).dateline},null,8,g)]),e.canAction?((0,l.wg)(),(0,l.iD)("div",v,[(0,s.SU)(h)?((0,l.wg)(),(0,l.j4)(k,{key:1,round:"",type:"warning",size:"small",onClick:S},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{icon:"group-line"}),(0,l.Uk)(" 取消关注 ")])),_:1})):((0,l.wg)(),(0,l.j4)(k,{key:0,round:"",type:"primary",size:"small",onClick:x},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{icon:"group-line"}),(0,l.Uk)(" 关注 ")])),_:1}))])):(0,l.kq)("",!0)]),(0,l._)("div",_,(0,r.zw)((0,s.SU)(b).subject),1),(0,l._)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.tags,(e=>((0,l.wg)(),(0,l.j4)(u,{key:e.id,to:{path:"/index",query:{tag:e.name}}},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{type:"info"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.name),1)])),_:2},1024)])),_:2},1032,["to"])))),128))])])):(0,l.kq)("",!0)}}};function b(e){e.__source="src/components/Topic/topic.vue"}var h=a(83744);"function"===typeof b&&b(y);const k=(0,h.Z)(y,[["__scopeId","data-v-b6ea1fbc"]]);var x=k},27750:function(e,t,a){a.d(t,{Z:function(){return f}});var n=a(30032),o=(a(3241),a(91154),a(97830)),i=(a(13768),a(66252)),l=a(2262),s=a(3577),r=a(22201),c=(0,i.aZ)({__name:"index",props:{header:{type:String,default:""},bodyStyle:{type:Object,default:()=>({})},shadow:{type:String,default:""},skeleton:{type:Boolean,default:!1},skeletonRows:{type:Number,default:4}},setup(e){let t=null;const a=(0,l.iH)(!0);return t=setTimeout((()=>{a.value=!1}),500),(0,r.iS)(((e,a,n)=>{clearInterval(t),n()})),(t,r)=>{const c=o.vk,u=n.Kf;return(0,i.wg)(),(0,i.j4)(u,{"body-style":e.bodyStyle,class:"vab-card",shadow:e.shadow},(0,i.Nv)({default:(0,i.w5)((()=>[e.skeleton?((0,i.wg)(),(0,i.j4)(c,{key:0,animated:"",loading:(0,l.SU)(a),rows:e.skeletonRows},{default:(0,i.w5)((()=>[(0,i.WI)(t.$slots,"default",{class:"vab-card-transition"})])),_:3},8,["loading","rows"])):(0,i.WI)(t.$slots,"default",{key:1,class:"vab-card-transition"})])),_:2},[t.$slots.header||e.header?{name:"header",fn:(0,i.w5)((()=>[(0,i.WI)(t.$slots,"header",{},(()=>[(0,i.Uk)((0,s.zw)(e.header),1)]))])),key:"0"}:void 0]),1032,["body-style","shadow"])}}});function u(e){e.__source="library/components/VabCard/index.vue"}var d=a(83744);"function"===typeof u&&u(c);const m=(0,d.Z)(c,[["__scopeId","data-v-391150ea"]]);var f=m}}]);